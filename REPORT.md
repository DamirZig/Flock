# Отчёт по ревью проекта: tgbiz (Chimi Business CRM)

## 1. Краткое описание проекта
**tgbiz** — это современная CRM-система для бизнеса, ориентированная на удобство управления пользователями, профилями и аналитикой. Проект разделен на высокопроизводительный бэкенд на Python и динамичный фронтенд на React. Основной акцент сделан на безопасности, скорости работы и эстетичном пользовательском интерфейсе.

---

## 2. Технологический стэк

### Backend (Бэкенд)
- **Core**: [FastAPI](https://fastapi.tiangolo.com/) — современный, быстрый веб-фреймворк для создания API.
- **Database ORM**: [SQLAlchemy](https://www.sqlalchemy.org/) — мощная библиотека для работы с базами данных (поддержка MySQL/SQLite).
- **Authentication**: [JWT (JSON Web Tokens)](https://jwt.io/) с использованием `python-jose`.
- **Security**: 
  - `passlib` (bcrypt) для безопасного хеширования паролей.
  - `slowapi` для реализации Rate Limiting (ограничение частоты запросов).
- **Environment**: `python-dotenv` для управления секретами и конфигурациями.
- **Validation**: `Pydantic` для строгой типизации данных.

### Frontend (Фронтенд)
- **Core**: [React 19](https://react.dev/) + [TypeScript](https://www.typescriptlang.org/).
- **Build Tool**: [Vite](https://vitejs.dev/) — сверхбыстрый инструмент сборки.
- **Data Fetching**: [TanStack Query (React Query) v5](https://tanstack.com/query/latest) — управление серверным состоянием, кэширование и синхронизация.
- **Styling**: [Tailwind CSS v4](https://tailwindcss.com/) — современный подход к верстке через utility-классы.
- **Animations**: [Framer Motion](https://www.framer.com/motion/) — сложные и плавные анимации интерфейса.
- **Routing**: [React Router v7](https://reactrouter.com/) — обновленный подход к навигации.
- **Icons**: `Lucide React` и `@iconify/react`.

---

## 3. Технические решения и Архитектура

### Корень проекта и конфигурация
- **.gitignore**: Тщательно настроен для исключения секретов (`.env`), виртуальных окружений (`venv/`), скомпилированных файлов Python (`__pycache__/`), зависимостей Node (`node_modules/`), артефактов сборки (`dist/`) и временных файлов IDE. Также включены правила для исключения артефактов Gemini/AI.
- **Модульность**: Проект четко разделен на `frontend` и `backend`, что позволяет масштабировать их независимо.

### Backend решения
1.  **Архитектура API**: Используется модульная структура с разделением на роутеры (`routers/auth.py`, `routers/users.py`), схемы данных (`schemas.py`), CRUD-операции (`crud.py`) и модели базы данных (`models.py`).
2.  **Безопасность сессий**: Реализована передача JWT-токена через **HttpOnly cookies**. Это предотвращает кражу токенов через XSS-атаки.
3.  **Обработка ошибок**: Глобальный Exception Handler в `main.py`, который перехватывает все непредвиденные ошибки, логирует их и возвращает пользователю дружелюбное сообщение, не раскрывая детали реализации.
4.  **Управление БД**: Настройка `NullPool` в SQLAlchemy для управления соединениями, что критично для стабильности при работе с удаленными базами данных.

### Frontend решения
1.  **Состояние авторизации**: Реализовано через `AuthContext`, который синхронизирован с React Query. Это позволяет избежать "Loading..." экранов при переходах, сохраняя данные в кэше.
2.  **Защищенные маршруты**: Используются компоненты-обертки `ProtectedRoute` и `AdminRoute` для контроля доступа к страницам на уровне роутинга.
3.  **Оптимизация UX**: 
    - Внедрены **Skeleton Screens** (скелетная загрузка) для улучшения субъективного времени ожидания.
    - Реализованы плавные переходы между страницами с помощью `AnimatePresence` и `PageTransition`.
    - Добавлен таймаут (10 сек) на все API-запросы с понятными уведомлениями об ошибках.

---

## 4. Сложные реализации

### 1. Безопасная авторизация "под ключ"
Реализован полный цикл:
- Регистрация с валидацией сложности пароля (Pydantic + кастомные тесты в `verify_security.py`).
- Автоматический вход после регистрации с установкой зашифрованной куки.
- Валидация сессии на сервере через эндпоинт `/users/me`.
- Удаление кук при логауте.

### 2. Интеграция Rate Limiting
Защита от brute-force атак на эндпоинты `/login` и `/register` с помощью `SlowAPI`. При превышении лимита (например, 5 попыток в минуту) сервер возвращает 429 ошибку, что подтверждено автоматизированными тестами.

### 3. Кастомная дизайн-система
В `frontend/src/components/ui` создана библиотека переиспользуемых компонентов:
- Динамические фоны (`GridBackground`, `AnimatedBackground`).
- Сложные модальные окна и уведомления (CookieConsent).
- Гибкие кнопки и инпуты с поддержкой анимаций Framer Motion.

---

## 5. Вывод
Проект **tgbiz** представляет собой профессионально спроектированное Single Page Application (SPA). Технические решения, такие как использование HttpOnly cookies, React Query для кэширования и Tailwind v4 для верстки, ставят проект в один ряд с современными enterprise-решениями. Код отличается высокой читаемостью, модульностью и готовностью к дальнейшему масштабированию.
